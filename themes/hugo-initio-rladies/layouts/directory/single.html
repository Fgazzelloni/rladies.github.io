{{ define "languages" }}
    {{ partial "languages.html" .}}
{{ end }}

{{ define "main" }}
	
	<!-- for searching and pagination List.js -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>  
  <script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  
<main id="main">
	<div class="container" >
		<div class="row topspace">

				<header class="entry-header">
 					<h1 class="entry-title"><a href="{{ .Permalink }}" rel="bookmark">{{ .Title }}</a></h1>
				</header>
				
        <div class="entry-content">
					{{ .Content }}
				</div>
		
        <div class="flex-container" id="directory-content">
          
          <center>
            <input type="text" style="border-radius: .5em;" class="fuzzy-search" placeholder="Search directory..."/>
            <buttonr style="font-size: 12px;" class="sort" data-sort="name">Sort by name</buttonr>
            <!-- <buttonr id="shuffle" style="font-size: 12px;" type="button">Randomly shuffle</buttonr> -->
          </center>
          
          <ul class="list" id="directory-grid">
            {{ if eq .Hugo.Environment "production" }}
              {{ $url := "https://raw.githubusercontent.com/rladies/directory/master/directory/rladies_directory.json?token=" }}
              {{ $pat := getenv "DIRECTORY_PAT" }}
              {{ $directory := getJSON $url $pat | shuffle }}
              {{ range $directory }}
                {{ partial "directory/li.html" . }}
              {{ end }}
              
            {{ else }}
              {{ $directory := $.Site.Data.directory | shuffle }}
              {{ range $directory }}
                {{ partial "directory/li.html" . }}
              {{ end }}
            {{ end }}

          </ul>
          <center>
            <div class="pagination-nav">
              <ul class="paginate_back"><i class="fas fa-chevron-left"></i></ul>
              <ul class="pagination"></ul>
              <ul class="paginate_next"><i class="fas fa-chevron-right"></i></ul>
            </div>
          </center>
        </div> 
		</div> <!-- /row post  -->
	</div>	<!-- /container -->
</main>
 
	<script>
    var directoryList = new List('directory-content', {
      valueNames: ['name', 'honorific', 'affiliation', 'interests', 'shiny_apps', 'r_groups', 'r_packages'],
      page: 10,
      pagination: {
        innerWindow: 2,
        left: 1,
        right: 1,
        paginationClass: "pagination",
      }
    });
    
    $('.paginate_next').on('click', function(){
	    var list = $('.pagination').find('li');
	    $.each(list, function(position, element){
	        if($(element).is('.active')){
	            $(list[position+1]).trigger('click');
	        }
	    })
	});


	$('.paginate_back').on('click', function(){
	    var list = $('.pagination').find('li');
	    $.each(list, function(position, element){
	        if($(element).is('.active')){
	            $(list[position-1]).trigger('click');
	        }
	    })
	});

	</script>
{{ end }}
